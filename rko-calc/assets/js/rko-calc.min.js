!function(e){"use strict";const t=wNumb({decimals:0,thousand:" ",suffix:" ₽"}),n=wNumb({decimals:0,thousand:" ",suffix:" шт"}),a=wNumb({decimals:0,thousand:" "}),s=wNumb({decimals:2,mark:",",thousand:" "}),l={min:[0,100],"10%":[2e4,500],"20%":[5e4,1e3],"30%":[1e5,2500],"40%":[15e4,5e3],"50%":[25e4,1e4],"60%":[5e5,25e3],"70%":[1e6,5e4],"85%":[2e6,1e5],max:3e6},o=[{ID:"income",range:{min:[0,100],"10%":[2e4,500],"20%":[5e4,1e3],"30%":[1e5,2500],"40%":[15e4,5e3],"50%":[25e4,1e4],"60%":[5e5,25e3],"70%":[1e6,1e5],"85%":[25e5,25e4],max:1e7},numberFormat:t},{ID:"payment_order",range:{min:[0,1],max:100},numberFormat:n},{ID:"people_transfer",range:l,numberFormat:t},{ID:"personal_transfer",range:l,numberFormat:t},{ID:"get_atm",range:l,numberFormat:t},{ID:"get_cashbox",range:l,numberFormat:t},{ID:"put_atm",range:l,numberFormat:t},{ID:"put_cashbox",range:l,numberFormat:t}];e(document).ready((function(){const n=e("#rko-calc-form");o.forEach((function(e){let t=document.getElementById(e.ID),a=document.getElementById(e.ID+"-slider");noUiSlider.create(a,{start:0,connect:"lower",range:e.range,format:e.numberFormat});let s=a.querySelector(".noUi-handle"),l=a.querySelector(".noUi-connects");t.value=e.numberFormat.to(Number(t.dataset.value)),a.noUiSlider.setHandle(0,t.dataset.value,null),l.addEventListener("click",(function(){s.focus()})),a.noUiSlider.on("start",(function(){s.focus()})),a.noUiSlider.on("update",(function(e,n){let a=e[n];t.value=a})),a.noUiSlider.on("change",(function(e,a,s){let l=e[a];t.value=l,t.dataset.value=Math.round(s[a]),n.submit()})),t.addEventListener("focus",(function(e){e.target.value=e.target.dataset.value,setTimeout((function(){e.target.setSelectionRange(0,e.target.value.length)}),1)}),!0),t.addEventListener("change",(function(t){t.target.dataset.value=Number(t.target.value.replace(/[^\d]/g,"")),a.noUiSlider.setHandle(0,t.target.dataset.value,null),t.target.value=e.numberFormat.to(Number(t.target.dataset.value)),t.target.hasChanged=!0})),t.addEventListener("blur",(function(t){t.target.hasChanged?t.target.hasChanged=!1:t.target.value=e.numberFormat.to(Number(t.target.dataset.value))}),!0),t.addEventListener("keypress",(function(e){let t=e||window.event,n=t.keyCode||t.which;n=String.fromCharCode(n);/[0-9]|\./.test(n)||(t.returnValue=!1,t.preventDefault&&t.preventDefault())}))}));const l=document.querySelector(".rko-calc"),r=document.querySelectorAll('input[name="ooo"]'),c=document.querySelector('label[for="personal_transfer"]'),i=document.querySelector('input[name="personal_transfer"]'),u=document.querySelector("#personal_transfer-slider");r.forEach((function(e){function n(e){e.checked&&"0"===e.value?(l.classList.add("color-bg-green"),c.classList.remove("dn")):e.checked&&"1"===e.value&&(l.classList.remove("color-bg-green"),c.classList.add("dn"),i.dataset.value=0,i.value=t.to(0),u.noUiSlider.setHandle(0,0,null))}n(e),e.addEventListener("change",(function(){n(e)}))}));const d=document.querySelector(".detailed-calculation"),p=document.querySelector(".detailed-calculation"),m=document.querySelectorAll(".detailed-hidden");function v(e){return`\n        <li>\n          ${e.from?"от "+s.to(e.from)+" ₽ ":e.to?"":"любая сумма "}\n          ${e.to?"до "+a.to(e.to)+" ₽ ":""}\n          ${e.cost?"— "+e.cost+"%":e.plus?"— ":e.pack?"— "+a.to(e.pack_cost)+" ₽ за каждые "+a.to(e.pack)+" ₽ (включая неполные)":"— бесплатно"}\n          ${e.cost&&e.plus?"+ ":""}\n          ${e.plus?e.plus+" ₽":""}\n          ${e.min_cost?", мин. "+e.min_cost+" ₽":""}\n        </li>\n      `}function f(e,t){return`\n        <div class="result-details-notes-title">${t}:</div>\n        <div class="result-details-notes-body">\n          <ul>\n            ${e.map(e=>`<li>${e}</li>`).join("")}\n          </ul>\n        </div>\n      `}d.addEventListener("click",(function(){p.classList.toggle("active"),m.forEach((function(e){e.classList.toggle("active")}))}));let b=0;function g(e,t){let n=e.user_params,s=rkoCalc.allTariffOptions[e.id];return b++,`\n        <li class="result-wrap">\n          <div class="result-position">${b}</div>\n          <div class="result-bank">\n            <img src="${s.bank.logo}" class="result-bank-logo" alt="Логотип ${s.bank.name.chto}">\n            <div class="result-bаnk-license">лиц. № ${s.bank.license.number}</div>\n          </div>\n          <div class="result-tariff">\n            <div class="result-tariff-label">Тариф</div>\n            <div class="result-tariff-name">${s.name}</div>\n          </div>\n          <div class="result-calculated">\n            <div class="result-calculated-sum price">${a.to(e.calculated_sum)} <span>₽/мес</span></div>\n            <div class="result-calculated-details">\n              <span>Детально</span><span> <svg class="open" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m11.9932649 19.500812c-.6352342.000819-1.2400333-.2833911-1.65984-.78l-9.41856003-11.15199999c-.61913211-.76859096-.53599584-1.91147321.1872475-2.57410938.72324334-.66263618 1.82204752-.60264878 2.4748325.13510938l8.23584003 9.75199999c.0455704.0541548.1113462.0852092.18048.0852092.0691337 0 .1349096-.0310544.18048-.0852092l8.23584-9.75199999c.4135143-.51333692 1.0615094-.75310007 1.6932379-.626511s1.1480791.59966995 1.3492454 1.2361798c.2011663.63650986.0555875 1.33658731-.3804033 1.8293312l-9.41568 11.14799999c-.4205256.497811-1.0261445.7833703-1.66272.784z" fill-rule="evenodd"/></svg><svg class="close" enable-background="new 0 0 24 24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m12 4.5c.6 0 1.2.3 1.7.8l9.4 11.2c.6.8.5 1.9-.2 2.6s-1.8.6-2.5-.1l-8.2-9.8c0-.2-.1-.2-.2-.2s-.1 0-.2.1l-8.2 9.8c-.4.5-1.1.8-1.7.6-.6-.1-1.1-.6-1.3-1.2s-.1-1.3.4-1.8l9.4-11.1c.4-.6 1-.9 1.6-.9z"/></svg></span>\n            </div>\n          </div>\n          <div class="result-button-wrap">\n            <a href="${s.button.url}" target="_blank" onclick="${s.button.onclick.calc_list}" class="result-button button button-small button-outline">Перейти на сайт</a>\n          </div>\n          <div class="result-details-wrap">\n            ${function(e,t,n){let s={corp_card:"Корпоративная карта",opening_cost:"Открытие счета",service:"Обслуживание счета",sms:"SMS-информирование"},l="",o=!0;for(let r in e)if(("personal_transfer"!=r||!n.ooo)&&("income"!=r&&"people_transfer"!=r&&"personal_transfer"!=r&&"get_atm"!=r&&"get_cashbox"!=r&&"put_atm"!=r&&"put_cashbox"!=r&&"payment_order"!=r&&"corp_card"!=r&&"sms"!=r||n[r])){switch(o?o=!1:l+="<hr class='result-details-sep'>",s.personal_transfer=`Перевод <span class="user-value">${a.to(n[r])} ₽</span> на личную карту в ${t.have_personal_card?t.bank.name.gde:"любом банке"}`,s.income=`Поступление <span class="user-value">${a.to(n[r])} ₽</span> на счет от юр. лиц и ИП`,s.people_transfer=`Перевод <span class="user-value">${a.to(n[r])} ₽</span> физ. лицам`,s.get_atm=`Снятие <span class="user-value">${a.to(n[r])} ₽</span> в банкомате`,s.get_cashbox=`Снятие <span class="user-value">${a.to(n[r])} ₽</span> в кассе банка`,s.put_atm=`Внесение <span class="user-value">${a.to(n[r])} ₽</span> в банкомате`,s.put_cashbox=`Внесение <span class="user-value">${a.to(n[r])} ₽</span> в кассе банка`,s.payment_order=`Платежные поручения <span class="user-value">(${a.to(n[r])} шт)</span>`,l+=`\n          <div class="result-details-param">\n            ${s[r]} — <span class="price">\n            ${e[r]?"opening_cost"==r?a.to(e[r])+" <span> ₽</span>":a.to(e[r])+" <span> ₽/мес</span>":"бесплатно"}\n            </span>\n            </div>\n            `,r){case"people_transfer":case"get_atm":l+=`\n              <div class="result-details-notes-title">Условия тарифа:</div>\n              <div class="result-details-notes-body">\n                <ul>\n                ${n.ooo?t[r].same_for_ooo?t[r].cond.map(v).join(""):t[r].cond_ooo.map(v).join(""):t[r].cond.map(v).join("")}\n                </ul>\n              </div>\n            `;break;case"personal_transfer":l+=`\n              <div class="result-details-notes-title">Условия тарифа:</div>\n              <div class="result-details-notes-body">\n                <ul>\n                ${t.personal_transfer_same_as_people_transfer?t.people_transfer.cond.map(v).join(""):t[r].cond.map(v).join("")}\n                </ul>\n              </div>\n            `;break;case"get_cashbox":case"put_cashbox":l+=`\n              ${t.have_cashbox?'<div class="result-details-notes-title">Условия тарифа:</div>':'<div class="result-details-notes-title">Обратите внимание:</div>'}\n              <div class="result-details-notes-body">\n                <ul>\n                ${t.have_cashbox?t[r].cond.map(v).join(""):"<li>в банке нет физических отделений с кассой, расчет выполнен по условиям операции через банкомат</li>"}\n                </ul>\n              </div>\n            `;break;case"income":e[r]&&(l+=`\n                <div class="result-details-notes-title">Условия тарифа:</div>\n                <div class="result-details-notes-body">\n                  <ul>\n                  ${t[r].cond.map(v).join("")}\n                  </ul>\n                </div>\n              `);break;case"put_atm":l+=`\n                  <div class="result-details-notes-title">Условия тарифа:</div>\n                  <div class="result-details-notes-body">\n                    <ul>\n                    ${t[r].cond.map(v).join("")}\n                    </ul>\n                  </div>\n                `;break;case"service":e[r]&&(l+=`\n                <div class="result-details-notes-title">Условия тарифа:</div>\n                <div class="result-details-notes-body">\n                  <ul>\n                  ${t[r].cond.map(e=>`<li>${e.period} мес — ${a.to(e.cost)} ₽</li>`).join("")}\n                  </ul>\n                </div>\n              `);break;case"payment_order":l+=`\n                <div class="result-details-notes-title">Условия тарифа:</div>\n                <div class="result-details-notes-body">\n                  <ul>\n                    ${t[r].free?"<li>до "+t[r].free+" шт — бесплатно</li><li>остальные — "+t[r].paid+" ₽/шт</li>":t[r].paid?"<li>"+t[r].paid+" ₽/шт</li>":"<li>любое количество — бесплатно</li>"}\n                  </ul>\n                </div>\n              `;break;case"corp_card":(t[r].cachback||t[r].free_period)&&(l+=`\n              <div class="result-details-notes-title">Бонусы:</div>\n              <div class="result-details-notes-body">\n                <ul>\n                  ${t[r].free_period?"<li>бесплатный период — "+t[r].free_period+"</li>":""}\n                  ${t[r].cachback?"<li>кэшбэк — "+t[r].cachback+"</li>":""}\n                </ul>\n              </div>\n            `)}if("opening_cost"!=r&&("put_cashbox"!=r&&"get_cashbox"!=r||t.have_cashbox)){let e=r,a="info";switch(r){case"personal_transfer":t.personal_transfer_same_as_people_transfer&&(e="people_transfer");break;case"people_transfer":case"get_atm":n.ooo&&!t[r].same_for_ooo&&(a="info_ooo")}let s=[],o=[],c=[];for(let n in t[e][a]){let l=t[e][a][n].type,r=t[e][a][n].text;"idea"==l&&s.push(r),"warning"==l&&o.push(r),"small"==l&&c.push(r)}s.length&&(l+=f(s,"Как сэкономить")),o.length&&(l+=f(o,"Обратите внимание")),c.length&&(l+=f(c,"Мелким шрифтом"))}}return l}(e.calculated,s,n)}\n            <div class="result-details-button-wrap">\n              <a href="${s.button.url}" target="_blank" onclick="${s.button.onclick.calc_ext}" class="result-details-button button button-small">Открыть счет с тарифом «${s.name}»</a>\n            </div>\n          </div>\n        </li>\n      `}function _(){let e=document.querySelectorAll(".result-calculated-details"),t=document.querySelectorAll(".result-details-wrap");e.forEach((function(e,n){"true"!==e.getAttribute("listener")&&(e.setAttribute("listener","true"),e.addEventListener("click",(function(){e.classList.toggle("active"),t[n].classList.toggle("active")})))}))}function h(t){let a=function(e){for(var t=[],n=0;n<e.elements.length;n++){var a=e.elements[n];a.name&&!a.disabled&&"file"!==a.type&&"reset"!==a.type&&"submit"!==a.type&&"button"!==a.type&&(("checkbox"!==a.type&&"radio"!==a.type||a.checked)&&(a.dataset.value?t.push(encodeURIComponent(a.name)+"="+encodeURIComponent(a.dataset.value)):t.push(encodeURIComponent(a.name)+"="+encodeURIComponent(a.value))))}return t.join("&")}(n[0]);if(!t){let e=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+a+"#rko-calc-results";history.replaceState&&history.replaceState(null,null,e);for(let e=0;e<a2a_config.callbacks.length;e++)"share"in a2a_config.callbacks[e]&&a2a_config.callbacks.splice(e,1);a2a_config.callbacks.push({share:function(){return{url:e,title:"Мой рейтинг банков для открытия расчетного счета:"}}})}e.ajax({type:"GET",url:rkoCalc.restURL+"rko-calc/v1/calculate?"+a,data:a,beforeSend:function(){e(".preloader").show()},complete:function(){e(".preloader").hide()},success:function(t){b=0,function(t){const n=t.length;let a=0,s=n-5>0?5:n,l=n-5>0?n-5:0,o=t[0].user_params.ooo;document.querySelector("#rko-calc-results").innerHTML=`\n        <h2>Личный рейтинг банков для ${o?"ООО":"ИП"}</h2>\n        <ul class="rko-calc-results-list">\n          <div class="preloader"><div class="spin"></div></div>\n          ${t.slice(a,s).map(g).join("")}\n        </ul>\n      `,l&&e("#rko-calc-results").append(`\n        <button class="load-more-results">Показать еще ${l>5?5:l}</button>\n      `),_();let r=document.querySelector(".load-more-results");null!==r&&r.addEventListener("click",(function(){a+=5,s+=5,l=l-5>0?l-5:0,e(".rko-calc-results-list").append(t.slice(a,s).map(g).join("")),l?r.innerHTML=`\n        Показать еще ${l>5?5:l}\n        `:r.style.display="none",_()}))}(t)}})}h(!0),n.change((function(){n.submit()})),n.on("submit",(function(e){e.preventDefault(),h(!1)}))}))}(jQuery);